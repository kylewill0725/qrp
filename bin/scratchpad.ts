import {ItemDrop, Relic} from '../relic';
import {DOMParser} from "xmldom";
import * as select from 'xpath.js';
import * as https from 'https';

function getRelicDrops(): Promise<Relic[]> {
    return new Promise((resolve, reject) => {
        let content = "";
        https.get('https://n8k6e2y6.ssl.hwcdn.net/repos/hnfvc0o3jnfvc873njb03enrf56.html', (response) => {
            response.on('data', (d) => {
                content += d;
            });
            response.on('end', parseWarframeDropsSite);
        });
        function parseWarframeDropsSite() {
            const dom = new DOMParser().parseFromString(content);
            const relicRewardsTable = select(dom, '//h3[@id="relicRewards"]')[0].nextSibling;
            const relicDomList = select(relicRewardsTable, 'child::tr[th[contains(text(), "Intact")]]'); //Selects the table row of the relic header. The six siblings after this header are drops.
            let relicList: Relic[] = [];

            const rarities = {
                'intact': [0.2533, 0.11, 0.02],
                'exceptional': [0.2333, 0.13, 0.04],
                'flawless': [0.2, 0.17, 0.06],
                'radiant': [0.1667, 0.2, 0.1]
            };

            relicDomList.forEach((relicDom) => {
                let [era, type,, quality] = relicDom.firstChild.firstChild.data.replace(/[\(\)]/g, '').split(' ');
                let items: ItemDrop[] = [];

                let currentRow = select(relicDom, 'following-sibling::tr[1]')[0];
                for (let i = 0; i < 6; i++) {
                    const re = /(.*) +(prime) *(.*)/;
                    if (currentRow.firstChild.firstChild.data.toLowerCase().indexOf('forma') != -1) {
                        currentRow = select(currentRow, 'following-sibling::tr[1]')[0];
                        continue;
                    }
                    let [,itemName,,component] = currentRow.firstChild.firstChild.data.toLowerCase().match(re);
                    itemName = itemName.replace(/&/g, 'and');
                    component = component.replace(' blueprint', '');
                    if (itemName.includes('kavasa')) {
                        if (component.includes('collar')) component = 'collar blueprint';
                        else if (component.includes('buckle')) component = 'collar buckle';
                        else if (component.includes('band')) component = 'collar band';
                    }
                    let itemDropDomChance = currentRow.lastChild.firstChild.data.match(/(\w+) \((\d+).(\d+)%\)/);
                    let itemDropRarity = itemDropDomChance[1];
                    let itemChance = parseInt(itemDropDomChance[2]+itemDropDomChance[3])/10000;
                    let itemRarity = rarities[quality.toLowerCase()].indexOf(itemChance);


                    items.push(new ItemDrop({
                        name: itemName,
                        component: component,
                        rarity: itemRarity,
                        dropRarity: itemDropRarity,
                        chance: itemChance
                    }));

                    currentRow = select(currentRow, 'following-sibling::tr[1]')[0];
                }

                relicList.push(new Relic({
                    era: era,
                    type: type,
                    items: items,
                    rating: quality
                }));
            });
            resolve(relicList);
        }
    });
}

// getRelicDrops();

const testRelics: Relic[] = JSON.parse(`[{"era": "Axi","type": "A1","rating": "Intact","items": [{"name": "akstiletto","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fragor","component": "head","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "dual kamas","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "braton","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nikana","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02}]},{"era": "Axi","type": "A2","rating": "Intact","items": [{"name": "aklex","component": "link","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "aklex","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "lex","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "lex","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "B1","rating": "Intact","items": [{"name": "banshee","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "cernos","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "kavasa","component": "collar buckle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "euphona","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ash","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "B2","rating": "Intact","items": [{"name": "banshee","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "orthos","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fragor","component": "head","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "sybaris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "C1","rating": "Intact","items": [{"name": "cernos","component": "lower limb","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "orthos","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "vectis","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "C2","rating": "Intact","items": [{"name": "cernos","component": "lower limb","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "silva and aegis","component": "blade","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fragor","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "E1","rating": "Intact","items": [{"name": "ember","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "glaive","component": "blade","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "latron","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "sicarus","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "frost","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "E2","rating": "Intact","items": [{"name": "euphona","component": "receiver","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "bronco","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "G1","rating": "Intact","items": [{"name": "galatine","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "kavasa","component": "collar blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "nekros","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "saryn","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "H1","rating": "Intact","items": [{"name": "helios","component": "cerebrum","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "akstiletto","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "chassis","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fragor","component": "head","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "vectis","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "H2","rating": "Intact","items": [{"name": "helios","component": "cerebrum","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "trinity","component": "chassis","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "akstiletto","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "oberon","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "K1","rating": "Intact","items": [{"name": "kavasa","component": "collar buckle","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "odonata","component": "harness","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "hikou","component": "pouch","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "akstiletto","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "lex","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "N1","rating": "Intact","items": [{"name": "akstiletto","component": "link","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "braton","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "odonata","component": "wings","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fang","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ash","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02}]},{"era": "Axi","type": "N2","rating": "Intact","items": [{"name": "carrier","component": "carapace","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nikana","component": "hilt","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "ash","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "N3","rating": "Intact","items": [{"name": "nekros","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "volt","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "bronco","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "upper limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "dual kamas","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "N4","rating": "Intact","items": [{"name": "nikana","component": "hilt","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "hydroid","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fragor","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "cernos","component": "upper limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nekros","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "galatine","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "N5","rating": "Intact","items": [{"name": "nami skyla","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "nekros","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "helios","component": "systems","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "euphona","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "oberon","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "O1","rating": "Intact","items": [{"name": "oberon","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "akstiletto","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "galatine","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "euphona","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "R1","rating": "Intact","items": [{"name": "rhino","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "dakra","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "ankyros","component": "blade","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "boltor","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "mag","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "boar","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "S1","rating": "Intact","items": [{"name": "bronco","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "akbronco","component": "link","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "scindo","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "trinity","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Axi","type": "T1","rating": "Intact","items": [{"name": "tigris","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "akstiletto","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "burston","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "vectis","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "odonata","component": "harness","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "saryn","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "V1","rating": "Intact","items": [{"name": "odonata","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "vauban","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "carrier","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "dual kamas","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "volt","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Axi","type": "V2","rating": "Intact","items": [{"name": "vectis","component": "stock","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "hikou","component": "pouch","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "mag","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "boar","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Axi","type": "V3","rating": "Intact","items": [{"name": "vectis","component": "stock","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "orthos","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "braton","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "vasto","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "trinity","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "V4","rating": "Intact","items": [{"name": "vectis","component": "stock","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "cernos","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "trinity","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "odonata","component": "harness","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "V5","rating": "Intact","items": [{"name": "valkyr","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "braton","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "tigris","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "venka","component": "blades","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "dual kamas","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Axi","type": "V6","rating": "Intact","items": [{"name": "valkyr","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "fang","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "galatine","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "braton","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ballistica","component": "lower limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "A1","rating": "Intact","items": [{"name": "saryn","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "vectis","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "braton","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "akstiletto","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "vasto","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "A2","rating": "Intact","items": [{"name": "akstiletto","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "akbronco","component": "link","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "cernos","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "lex","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "valkyr","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "B1","rating": "Intact","items": [{"name": "boar","component": "stock","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "rhino","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "boltor","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "mag","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ankyros","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "B2","rating": "Intact","items": [{"name": "ballistica","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "orthos","component": "blade","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "braton","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "lower limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "tigris","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "C1","rating": "Intact","items": [{"name": "carrier","component": "cerebrum","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "kavasa","component": "collar band","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fang","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nova","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nova","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "F1","rating": "Intact","items": [{"name": "scindo","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fragor","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "odonata","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "F2","rating": "Intact","items": [{"name": "odonata","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "hikou","component": "stars","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "upper limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "burston","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "vauban","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "fang","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Lith","type": "G1","rating": "Intact","items": [{"name": "glaive","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "ember","component": "systems","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "latron","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "frost","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "reaper","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "H1","rating": "Intact","items": [{"name": "helios","component": "cerebrum","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "akstiletto","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "nami skyla","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "saryn","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "K1","rating": "Intact","items": [{"name": "kavasa","component": "collar buckle","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "tigris","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fang","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "burston","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "odonata","component": "harness","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "M1","rating": "Intact","items": [{"name": "mag","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "lex","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "soma","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "dakra","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "boar","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "N1","rating": "Intact","items": [{"name": "nova","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "akbronco","component": "link","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "nekros","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "N2","rating": "Intact","items": [{"name": "nekros","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "helios","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "kavasa","component": "collar band","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "upper limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "spira","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "carrier","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "N3","rating": "Intact","items": [{"name": "nekros","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "braton","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "sybaris","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "burston","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "valkyr","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "S1","rating": "Intact","items": [{"name": "paris","component": "grip","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "string","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "spira","component": "pouch","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "hikou","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "S2","rating": "Intact","items": [{"name": "soma","component": "stock","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "carrier","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "akbronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nyx","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "kavasa","component": "collar band","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Lith","type": "S3","rating": "Intact","items": [{"name": "spira","component": "pouch","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "ash","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "soma","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "carrier","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "akbronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "string","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "S4","rating": "Intact","items": [{"name": "saryn","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "trinity","component": "chassis","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "kavasa","component": "collar blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "lex","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "S5","rating": "Intact","items": [{"name": "spira","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "akbronco","component": "link","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "galatine","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "carrier","component": "carapace","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "burston","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "S6","rating": "Intact","items": [{"name": "spira","component": "pouch","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "kavasa","component": "collar band","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "valkyr","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fang","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "dual kamas","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "T1","rating": "Intact","items": [{"name": "tigris","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "ballistica","component": "upper limb","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "valkyr","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "burston","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "akbronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "V1","rating": "Intact","items": [{"name": "fragor","component": "handle","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "paris","component": "upper limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "volt","component": "systems","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "lower limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "burston","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "V2","rating": "Intact","items": [{"name": "vauban","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "paris","component": "upper limb","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fang","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "lower limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "V3","rating": "Intact","items": [{"name": "valkyr","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "tigris","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "helios","component": "systems","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "lower limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "cernos","component": "upper limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Lith","type": "V4","rating": "Intact","items": [{"name": "vauban","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "tigris","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "helios","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "spira","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nekros","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "venka","component": "blades","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "B1","rating": "Intact","items": [{"name": "boar","component": "stock","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "dakra","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "mag","component": "chassis","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "orthos","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "orthos","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Meso","type": "C1","rating": "Intact","items": [{"name": "carrier","component": "cerebrum","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "nova","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "scindo","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "saryn","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ash","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Meso","type": "C2","rating": "Intact","items": [{"name": "carrier","component": "cerebrum","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "valkyr","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "odonata","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "cernos","component": "upper limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "galatine","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "C3","rating": "Intact","items": [{"name": "cernos","component": "lower limb","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "saryn","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "helios","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "lex","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nami skyla","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "burston","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "D1","rating": "Intact","items": [{"name": "orthos","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "orthos","component": "blade","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "dual kamas","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "lex","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "F1","rating": "Intact","items": [{"name": "fragor","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "nekros","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "dual kamas","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "bronco","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "lower limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "saryn","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "F2","rating": "Intact","items": [{"name": "frost","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "reaper","component": "blade","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "latron","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ember","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "sicarus","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "G1","rating": "Intact","items": [{"name": "galatine","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "silva and aegis","component": "blade","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "ballistica","component": "string","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "venka","component": "blades","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "M1","rating": "Intact","items": [{"name": "mag","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "boar","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "rhino","component": "chassis","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "dakra","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "boltor","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ankyros","component": "gauntlet","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "N1","rating": "Intact","items": [{"name": "fang","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nyx","component": "neuroptics","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "dual kamas","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Meso","type": "N2","rating": "Intact","items": [{"name": "ash","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "vauban","component": "neuroptics","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "hikou","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "N3","rating": "Intact","items": [{"name": "nekros","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "euphona","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "carrier","component": "cerebrum","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "burston","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "N4","rating": "Intact","items": [{"name": "nikana","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "oberon","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "upper limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "saryn","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "orthos","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "N5","rating": "Intact","items": [{"name": "nekros","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "hydroid","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "tigris","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "braton","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "O1","rating": "Intact","items": [{"name": "oberon","component": "neuroptics","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "akstiletto","component": "link","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "cernos","component": "string","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "akbronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "lower limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "S1","rating": "Intact","items": [{"name": "soma","component": "stock","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "paris","component": "upper limb","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "odonata","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "nova","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "tigris","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "S2","rating": "Intact","items": [{"name": "saryn","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "paris","component": "grip","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "string","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "galatine","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "S3","rating": "Intact","items": [{"name": "spira","component": "pouch","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "ash","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "valkyr","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nekros","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "akbronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "S4","rating": "Intact","items": [{"name": "saryn","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "fang","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fang","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "banshee","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "galatine","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "S5","rating": "Intact","items": [{"name": "sybaris","component": "barrel","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "saryn","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "burston","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "S6","rating": "Intact","items": [{"name": "spira","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "cernos","component": "string","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "tigris","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "galatine","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "helios","component": "carapace","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "valkyr","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "V1","rating": "Intact","items": [{"name": "burston","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "spira","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "carrier","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "vectis","component": "receiver","rarity": 2,"__dropRarity": "Rare","chance": 0.02}]},{"era": "Meso","type": "V2","rating": "Intact","items": [{"name": "vasto","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ash","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nikana","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "volt","component": "chassis","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Meso","type": "V3","rating": "Intact","items": [{"name": "valkyr","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "kavasa","component": "collar band","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "volt","component": "chassis","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "carrier","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "spira","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "V4","rating": "Intact","items": [{"name": "vauban","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "valkyr","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "ash","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "carrier","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Meso","type": "V5","rating": "Intact","items": [{"name": "venka","component": "gauntlet","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "euphona","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "silva and aegis","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "bronco","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "cernos","component": "grip","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "spira","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "A1","rating": "Intact","items": [{"name": "akstiletto","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "cernos","component": "string","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "vectis","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "carrier","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "B1","rating": "Intact","items": [{"name": "banshee","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "vectis","component": "stock","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "burston","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "string","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "trinity","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "B2","rating": "Intact","items": [{"name": "banshee","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "venka","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "tigris","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "B3","rating": "Intact","items": [{"name": "boltor","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "mag","component": "chassis","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "dakra","component": "blade","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "boar","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "rhino","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "D1","rating": "Intact","items": [{"name": "dakra","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "mag","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "trinity","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "vasto","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "boar","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "H1","rating": "Intact","items": [{"name": "hydroid","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "banshee","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "tigris","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "orthos","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fragor","component": "head","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "burston","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "N1","rating": "Intact","items": [{"name": "nyx","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "soma","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "kavasa","component": "collar blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "hikou","component": "stars","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "vectis","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "N2","rating": "Intact","items": [{"name": "lex","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "vauban","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "fang","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "vasto","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nova","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Neo","type": "N3","rating": "Intact","items": [{"name": "nekros","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "fang","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "ash","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "lex","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "odonata","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "string","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "N4","rating": "Intact","items": [{"name": "nikana","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "venka","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "paris","component": "string","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ash","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "N5","rating": "Intact","items": [{"name": "nikana","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "ash","component": "systems","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "akstiletto","component": "link","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "saryn","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "helios","component": "carapace","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "N6","rating": "Intact","items": [{"name": "nikana","component": "hilt","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "sybaris","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "bronco","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "galatine","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "cernos","component": "upper limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "N7","rating": "Intact","items": [{"name": "nekros","component": "systems","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "banshee","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "valkyr","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "trinity","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "euphona","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "venka","component": "blades","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "S1","rating": "Intact","items": [{"name": "saryn","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "trinity","component": "chassis","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "carrier","component": "carapace","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "lex","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "soma","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "S2","rating": "Intact","items": [{"name": "nyx","component": "systems","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "saryn","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "burston","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "lower limb","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nova","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "upper limb","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11}]},{"era": "Neo","type": "S3","rating": "Intact","items": [{"name": "soma","component": "barrel","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "vasto","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "spira","component": "blade","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "carrier","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "burston","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "S5","rating": "Intact","items": [{"name": "sicarus","component": "receiver","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "glaive","component": "disc","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "frost","component": "systems","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "latron","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "ember","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "reaper","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "S6","rating": "Intact","items": [{"name": "silva and aegis","component": "guard","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "tigris","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "kavasa","component": "collar buckle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "burston","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "trinity","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "S7","rating": "Intact","items": [{"name": "silva and aegis","component": "guard","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "sybaris","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "ballistica","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "banshee","component": "neuroptics","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "fang","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "helios","component": "carapace","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "S8","rating": "Intact","items": [{"name": "spira","component": "pouch","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "nikana","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fragor","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "bronco","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "hydroid","component": "chassis","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "T1","rating": "Intact","items": [{"name": "tigris","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "banshee","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fragor","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "dual kamas","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "burston","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "V1","rating": "Intact","items": [{"name": "nyx","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "volt","component": "blueprint","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "dual kamas","component": "blueprint","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "nova","component": "chassis","rarity": 2,"__dropRarity": "Rare","chance": 0.02}]},{"era": "Neo","type": "V2","rating": "Intact","items": [{"name": "vauban","component": "blueprint","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "galatine","component": "handle","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "fang","component": "handle","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "braton","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "galatine","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "V3","rating": "Intact","items": [{"name": "vauban","component": "neuroptics","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "tigris","component": "receiver","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "galatine","component": "blade","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "string","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "carrier","component": "systems","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "V4","rating": "Intact","items": [{"name": "venka","component": "gauntlet","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "saryn","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "ash","component": "neuroptics","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "cernos","component": "grip","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "tigris","component": "stock","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "bronco","component": "receiver","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]},{"era": "Neo","type": "V5","rating": "Intact","items": [{"name": "vauban","component": "neuroptics","rarity": 2,"__dropRarity": "Rare","chance": 0.02},{"name": "burston","component": "barrel","rarity": 1,"__dropRarity": "Uncommon","chance": 0.11},{"name": "helios","component": "carapace","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "paris","component": "string","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533},{"name": "silva and aegis","component": "hilt","rarity": 0,"__dropRarity": "Uncommon","chance": 0.2533}]}]`);
let items: ItemDrop[] = [];
testRelics.forEach((relic) => {
    relic.items.forEach((item) => {
        let name = `${item.name} prime ${item.component}`.replace(' ', '_');
        if (!items.some((varitem) => varitem.name == item.name && varitem.component == item.component)) {
            items.push(item);
        }
    })
});

function getItemPrices(item: ItemDrop) {
    return new Promise<{avg_price: number, low: number, high: number, ducats: number, ducats_per_plat: number}>((resolve, reject) => {
        const itemUrlName = `${item.name} prime ${item.component}`.replace(/ /g, '_');
        let result = "";
        let request = https.request({
            host: 'api.warframe.market',
            path: `/v1/items/${itemUrlName}/statistics?include=item`,
            headers: {
                'Language': 'end',
                'Platform': 'pc',
                'Content-Type': 'application/json'
            }
        },response => {
            response.on('data', (data) => {
                result += data;
            });
            response.on('end', () => {
                let priceData = {avg_price: 0, low: 0, high: 0, ducats: 0, ducats_per_plat: 0};
                let resultObj = JSON.parse(result);
                let itemPriceData = resultObj['payload']['statistics']['48hours'];
                priceData.ducats = resultObj['include']['item']['items_in_set'].filter((item) => item['url_name'] == itemUrlName)[0]['ducats'];

                let i = 1;
                for (let sold = 0; i <= itemPriceData.length && sold < 10; i++) {
                    priceData.avg_price += itemPriceData[itemPriceData.length - i]['avg_price'];
                    priceData.low += itemPriceData[itemPriceData.length - i]['min_price'];
                    priceData.high += itemPriceData[itemPriceData.length - i]['max_price'];
                    sold += itemPriceData[itemPriceData.length - i]['volume'];
                }
                priceData.avg_price /= i;
                priceData.low /= i;
                priceData.high /= i;
                priceData.ducats_per_plat = priceData.ducats/priceData.avg_price;

                resolve(priceData);
            });
        });
        request.on('error', (err) => {
            reject(err);
        });
        request.end();
    });
}


let prices = [];
let promises = [];
items.forEach((item) => promises.push(getItemPrices(item).then((value) => prices.push(value)).catch(reason => console.log(reason))));
Promise.all(promises).then(value => {
    console.log('done');
});